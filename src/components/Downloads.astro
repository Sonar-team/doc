---
import { Icon, LinkCard, CardGrid } from "@astrojs/starlight/components";

const data: { name: string; browser_download_url: string }[] = await fetch(
  "https://api.github.com/repos/Sonar-team/Sonar_desktop_app/releases/latest"
)
.then((data) => data.json())
.then((data) => data.assets)
.then((data) =>
  data.filter(
    ({ name }: { name: string }) =>
      name.endsWith(".AppImage") ||
      name.endsWith(".deb") ||
      name.includes("_x64-setup.exe") ||
      name.endsWith("_x64.dmg") ||
      name.endsWith("_x64_fr-FR.msi") ||
      name.endsWith(".rpm") ||
      name.endsWith(".app.tar.gz")
  )
);
---
  <>
    <h2 style={{ display: "flex" }}>
      <span style={{ marginLeft: "12px" }}>üñ•Ô∏è Windows</span>
    </h2>
    <CardGrid>
      <LinkCard
        title="üëÅÔ∏è D√©pendance Npcap"
        description="‚ö†Ô∏è‚ö†Ô∏è Installation requise : Npcap est n√©cessaire ‚ö†Ô∏è‚ö†Ô∏è"
        href="https://npcap.com/dist/npcap-1.81.exe"
      />
      <LinkCard
        title="üöÄ Windows Setup (.exe)"
        description="T√©l√©charger l'installateur pour Windows"
        href={data.find(({ name }) => name.includes("_x64-setup.exe"))?.browser_download_url}
      />

      <LinkCard
        title="üíø Windows MSI (.msi)"
        description="Installer via MSI pour Windows (n√©cessite une post-installation en ligne)"
        href={data.find(({ name }) => name.endsWith("_x64_fr-FR.msi"))?.browser_download_url}
      />
    </CardGrid>

    <h2 style={{ display: "flex" }}>
      <span style={{ marginLeft: "12px" }}>üêß Linux</span>
    </h2>
    <CardGrid>
      <LinkCard
        title="üì¶ Debian Binary (.deb)"
        description="Binary pour Debian, Ubuntu, et autres distributions bas√©es sur Debian"
        href={data.find(({ name }) => name.endsWith(".deb"))?.browser_download_url}
      />

      <LinkCard
        title="üìÄ Linux AppImage"
        description="AppImage pour Linux"
        href={data.find(({ name }) => name.endsWith(".AppImage"))?.browser_download_url}
      />
      <LinkCard
      title="üé© Linux Binary(rpm)"
      description="Binary pour fedora et autres distributions bas√©es sur Red hat"
      href={data.find(({ name }) => name.endsWith(".rpm"))?.browser_download_url}
    />
    </CardGrid>

    <h2 style={{ display: "flex" }}>
      <span style={{ marginLeft: "12px" }}>üçè MacOS</span>
    </h2>
    <CardGrid>
      <LinkCard
        title="üçè MacOS (.dmg)"
        description="T√©l√©charger l'installateur pour MacOS"
        href={data.find(({ name }) => name.endsWith("_x64.dmg"))?.browser_download_url}
      />

      <LinkCard
        title="üì¶ MacOS Tarball (.tar.gz)"
        description="Tarball pour MacOS"
        href={data.find(({ name }) => name.endsWith(".app.tar.gz"))?.browser_download_url}
      />
    </CardGrid>
  </>

